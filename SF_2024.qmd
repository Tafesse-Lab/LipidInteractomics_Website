---
title: "Farley et al. 2024"
format: 
  html:
    embed-resources: true
standalone: true
---

```{r setup, echo=FALSE, include=FALSE}
## intitialize libraries
library(dplyr)
library(tidyr)
library(plotly)
library(ggplot2)
library(grid)
library(readr)
library(rmarkdown)
library(emojifont)
library(gt)
library(crosstalk)
library(DT)

## Opening the source file for the ggplot custom theme
source("ggplot_styles.R")

## Some data wrangling to clean up Scotty's data
SF_2024_data_raw <- readr::read_csv("DataTables/SF_ACS-ChemBio_2024_Limma_results_V3.csv") 

SF_2024_data <- SF_2024_data_raw |>
	select(gene_name, keep_Huh7, comparison, logFC, pvalue, hit_annotation) |>
	filter(keep_Huh7 == TRUE) |>
	select(-keep_Huh7) |>
	mutate(LipidProbe = case_when(comparison == "FA_8_3_UV - FA_8_3_noUV" ~ "8-3 FA",
															 comparison == "FA_1_10_UV - FA_1_10_noUV" ~ "1-10 FA",
															 comparison == "Spa_UV - Spa_noUV" ~ "Spa",
															 comparison == "Sph_UV - Sph_noUV" ~ "Sph")) |>
	filter(LipidProbe == "8-3 FA" | LipidProbe == "1-10 FA" | LipidProbe == "Spa" | LipidProbe == "Sph") |>
	select(-comparison) |>
	glimpse()

# Organize the hit annotations as factors
SF_2024_data$hit_annotation <- factor(pull(SF_2024_data, hit_annotation), levels = c("enriched hit", "hit", "enriched candidate", "candidate", "no hit", "NA"), ordered = TRUE)

# Organize the probes as factors
SF_2024_data$LipidProbe <- factor(pull(SF_2024_data, LipidProbe), levels = c("Spa", "Sph", "8-3 FA", "1-10 FA"), ordered = TRUE)

# Building an ID column to maintain the order on the x-axis
ID <- c()
for(i in 0:(nrow(SF_2024_data)/4)){
	ID[i] = i
}

# Applies the ID column to the 1-10 FA results
SF_2024_ranked_1_10_FA <- SF_2024_data |>
    arrange(logFC) |>
	filter(LipidProbe == "1-10 FA") |>
	mutate(ID = ID) 

# Applies the ID column to the 8-3 FA results
SF_2024_ranked_8_3_FA <- SF_2024_data |>
    arrange(logFC) |>
	filter(LipidProbe == "8-3 FA") |>
	mutate(ID = ID) 

# Applies the ID column to the Spa results
SF_2024_ranked_Spa <- SF_2024_data |>
    arrange(logFC) |>
	filter(LipidProbe == "Spa") |>
	mutate(ID = ID) 

# Applies the ID column to the Sph results
SF_2024_ranked_Sph <- SF_2024_data |>
    arrange(logFC) |>
	filter(LipidProbe == "Sph") |>
	mutate(ID = ID) 

# Assembles the dataset to plot
SF_2024_ranked <- rbind(SF_2024_ranked_Sph, SF_2024_ranked_Spa, SF_2024_ranked_8_3_FA, SF_2024_ranked_1_10_FA)



unique(SF_2024_data$hit_annotation)

print(head(SF_2024_data))
```

## Publication information

**Title:** Trifunctional Sphinganine: A New Tool to Dissect Sphingolipid Function

**Authors:** Scotland E. Farley, Frank Stein, Per Haberkant, Fikadu G. Tafesse, Carsten Schultz*

(* corresponding: <schulcar@ohsu.edu>{target="_blank"})

**Date published:** 

**Journal, ISSN:** [ACS Chemical Biology](https://pubs.acs.org/doi/10.1021/acschembio.3c00554){target="_blank"}, 1554-8929, 1554-8937

**DOI:** <https://doi.org/10.1021/acschembio.3c00554>{target="_blank"}

## Abstract

Functions of the sphingolipids sphingosine and sphinganine in cells are not well established. While some signaling roles for sphingosine have been elucidated, the closely related sphinganine has been described only insofar as it does not elicit many of the same signaling responses. The underlying mechanisms behind the cell biological differences between these lipids are not well understood. Here, we prepared multifunctionalized derivatives of the two lipid species that only differ in a single double bond of the carbon backbone. Using these novel probes, we were able to define their spatiotemporal distribution within cells. Furthermore, we used these tools to systematically map the protein interactomes of both lipids. The lipid-protein conjugates, prepared through photo-crosslinking in live cells and extraction via click chemistry to azide beads, revealed significant differences in the captured proteins, highlighting their distinct roles in various cellular processes. This work elucidates mechanistic differences between these critical lipids and sets the foundation for further studies on the functions of sphingosine and sphinganine.

## Data visualization

#### Ranked-order Log2 Fold-change plots

:::{.border}
```{r, echo=FALSE}
#| fig-cap: ""

RankedOrderPlotStandard(SF_2024_ranked)
```
:::

#### Volcano plots

:::{.border}
```{r, echo=FALSE}
#| fig-cap: ""

VolcanoPlotStandardized(SF_2024_data)


```
:::

## Enriched Proteins


:::{.border}
```{r, echo=FALSE, warning=FALSE}
### Here is the code to make the filterable lists shown in the crosstalk table below

# Creates a reactive dataframe
SF_2024_data_reactive <- crosstalk::SharedData$new(SF_2024_data)


filter_select(id = "LipidProbe",
				label = "Functional probe used in pulldown:", 
				sharedData = SF_2024_data_reactive,
				group = ~LipidProbe)

filter_select(id = "hit_annotation",
				label = "Enrichment criteria:", 
				sharedData = SF_2024_data_reactive,
				group = ~hit_annotation)

datatable(SF_2024_data_reactive)
```
:::
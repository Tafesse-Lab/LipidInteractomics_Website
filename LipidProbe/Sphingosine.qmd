---
title: "Trifunctional Sphingosine"
format: html
prefer-html: true
---



## Structure

:::{.border}
![](/LipidProbe/Structures/SphingosineStructure.png)
:::

## Protein interactome

### Cell background: Huh7

::: {.callout-note collapse="true"}

{{< include /StudyInformation_includes/SF_2024_A_include.qmd >}}

:::


::: {.panel-tabset}

<!-- Data wrangling to make the plots -->

```{r setup, echo=FALSE, warning=FALSE, include = FALSE}
## intitialize libraries
library(dplyr)
library(tidyr)
library(plotly)
library(ggplot2)
library(grid)
library(readr)
library(rmarkdown)
library(emojifont)
library(gt)
library(crosstalk)
library(DT)
library(here)

## Opening the source file for the ggplot custom theme
source(paste0(here(), "/Resources/ggplot_styles.R"))


#  SF_2024_data <- readr::read_csv("LipidProbe/DataSets/SF_ACS-Chem-Bio_2024_download.csv") |>
#  	filter(LipidProbe == "Sph")

# 	write.csv(SF_2024_data, "LipidProbe/DataSets/Sph_Huh7_SF_2024.csv")

# Opening the datatable for this page
data <- readr::read_csv(paste0(here(), "/LipidProbe/DataSets/Sph_Huh7_SF_2024.csv")) |>
	filter(LipidProbe == "Sph")

	

# Organizing the hit annotations as factors
data$hit_annotation <- factor(pull(data, hit_annotation), levels = c("enriched hit", "hit", "enriched candidate", "candidate", "no hit", "NA"), ordered = TRUE)

```

##### Volcano plot

:::{.border}
```{r, echo=FALSE, warning=FALSE}
#| fig-cap: "Data as reported in [Farley et al., 2024](/IndividualStudies/SF_2024.qmd). Black proteins are unenriched or depleted in the presence of probe, Purple enriched candidates are defined as proteins with a false discovery rate less than 0.2 and a fold change of at least 1.5-fold, and Orange enriched hits are defined as proteins with a false discovery rate less than 0.05 and a fold change of at least 2-fold in the +UV over the -UV)."

VolcanoPlotStandardized(data)
```
:::

##### Ranked order plot

:::{.border}
```{r, echo=FALSE, warning=FALSE}
#| fig-cap: "Data as reported in [Farley et al., 2024](/IndividualStudies/SF_2024.qmd). Black proteins are unenriched or depleted in the presence of probe, Purple enriched candidates are defined as proteins with a false discovery rate less than 0.2 and a fold change of at least 1.5-fold, and Orange enriched hits are defined as proteins with a false discovery rate less than 0.05 and a fold change of at least 2-fold in the +UV over the -UV)."

RankedOrderPlotStandard(data)
```
:::


##### MA Plot

:::{.border}
```{r, echo=FALSE, warning=FALSE}
#| fig-cap: "Data as reported in [Farley et al., 2024](/IndividualStudies/SF_2024.qmd). Black proteins are unenriched or depleted in the presence of probe, Purple enriched candidates are defined as proteins with a false discovery rate less than 0.2 and a fold change of at least 1.5-fold, and Orange enriched hits are defined as proteins with a false discovery rate less than 0.05 and a fold change of at least 2-fold in the +UV over the -UV)."

MAStandard(data)

```
:::
:::


## Gene Ontology enrichment

**In beta: GO analysis still under development**

::: {.panel-tabset}


#### Cell Compartment

:::{.border}

<iframe src="/LipidProbe/GO_plots/Sph_SF_2024_CC-DOTplot.html" width="100%" height="500px"></iframe>

(CC CNET plot failed in production)
:::

#### Molecular Function

:::{.border}

(No MF pathways identified among enriched hits and candidates.)

(MF CNET plot failed in production)
:::

#### Biological Process

:::{.border}

(No BP pathways identified among enriched hits and candidates.)


(BP CNET plot failed in production)
:::
:::

## Data exploration and download

Check the boxes below to filter by significance thresholds.

:::{.border}
```{r, echo=FALSE, warning=FALSE}

# Here is the code to make the filterable lists shown in the crosstalk table below

data <- data |>
  dplyr::select(gene_name, hit_annotation, logFC, pvalue, fdr) |>
  mutate(logFC = signif(logFC, digits=3),
          pvalue = signif(pvalue, digits=3),
          fdr = signif(fdr, digits = 3)) |>
  arrange(hit_annotation)
  
## Creates a reactive dataframe
data_reactive <- crosstalk::SharedData$new(data)

htmltools::tags$div(
  class = "filter-container",
  filter_checkbox(id = "hit_annotation",
                  label = "Enrichment criteria:", 
                  sharedData = data_reactive,
                  group = ~hit_annotation,
                  inline="true")
)

## Displays the reactive dataframe
datatable(data_reactive, 
          caption = "'No hit' proteins are unenriched or depleted in the presence of probe, 'enriched candidates' are defined as proteins with a false discovery rate less than 0.2 and a fold change of at least 1.5-fold, and 'enriched hits' are defined as proteins with a false discovery rate less than 0.05 and a fold change of at least 2-fold in the +UV over the -UV", 
          options = list(pageLength = 10),
                         colnames = c("Gene Name", "Lipid Probe", "Hit Annotation", "LogFC", "p value", "FDR"))

```


{{< downloadthis DataSets/Sph_Huh7_SF_2024.csv dname="Sph_Huh7_SF_ACS-Chem-Bio_download">}}

:::

### Cell background: HeLa


::: {.callout-note collapse="true"}

{{< include /StudyInformation_includes/DH_2017_include.qmd >}}

:::
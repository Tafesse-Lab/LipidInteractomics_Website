---
title: "Trifunctional Sphingosine"
format: html
prefer-html: true
---



## Structure

:::{.border}
![](/LipidProbe/Structures/SphingosineStructure.png)
:::

## Protein interactome

### Cell background: Huh7

::: {.callout-note collapse="true"}

{{< include /StudyInformation_includes/SF_2024_A_include.qmd >}}

:::


::: {.panel-tabset}

<!-- Data wrangling to make the plots -->

```{r setup, echo=FALSE, warning=FALSE, include = FALSE}
## intitialize libraries
library(dplyr)
library(tidyr)
library(plotly)
library(ggplot2)
library(grid)
library(readr)
library(rmarkdown)
library(emojifont)
library(gt)
library(crosstalk)
library(DT)
library(here)

## Opening the source file for the ggplot custom theme
source(paste0(here(), "/Resources/ggplot_styles.R"))


#  SF_2024_data <- readr::read_csv("LipidProbe/DataSets/SF_ACS-Chem-Bio_2024_download.csv") |>
#  	filter(LipidProbe == "Sph")

# 	write.csv(SF_2024_data, "LipidProbe/DataSets/Sph_Huh7_SF_2024.csv")

# Opening the datatable for this page
SF_2024_data <- readr::read_csv(paste0(here(), "/LipidProbe/DataSets/Sph_Huh7_SF_2024.csv")) |>
	filter(LipidProbe == "Sph")

	

# Organizing the hit annotations as factors
SF_2024_data$hit_annotation <- factor(pull(SF_2024_data, hit_annotation), levels = c("enriched hit", "hit", "enriched candidate", "candidate", "no hit", "NA"), ordered = TRUE)


# Building an ID column to maintain the order on the x-axis
ID <- c()
for(i in 0:(nrow(SF_2024_data))){
	ID[i] = i
}


# Applies the ID column to the Sph results
SF_2024_ranked <- SF_2024_data |>
    arrange(logFC) |>
	filter(LipidProbe == "Sph") |>
	mutate(ID = ID) 

```

##### Volcano plot

:::{.border}
```{r, echo=FALSE, warning=FALSE}
#| fig-cap: "Data as reported in [Farley et al., 2024](/IndividualStudies/SF_2024.qmd). Black proteins are unenriched or depleted in the presence of probe, Purple enriched candidates are defined as proteins with a false discovery rate less than 0.2 and a fold change of at least 1.5-fold, and Orange enriched hits are defined as proteins with a false discovery rate less than 0.05 and a fold change of at least 2-fold in the +UV over the -UV)."

VolcanoPlotStandardized(SF_2024_data)
```
:::

##### Ranked order plot

:::{.border}
```{r, echo=FALSE, warning=FALSE}
#| fig-cap: "Data as reported in [Farley et al., 2024](/IndividualStudies/SF_2024.qmd). Black proteins are unenriched or depleted in the presence of probe, Purple enriched candidates are defined as proteins with a false discovery rate less than 0.2 and a fold change of at least 1.5-fold, and Orange enriched hits are defined as proteins with a false discovery rate less than 0.05 and a fold change of at least 2-fold in the +UV over the -UV)."

RankedOrderPlotStandard(SF_2024_ranked)
```
:::


##### MA Plot

:::{.border}
```{r, echo=FALSE, warning=FALSE}
#| fig-cap: "Data as reported in [Farley et al., 2024](/IndividualStudies/SF_2024.qmd). Black proteins are unenriched or depleted in the presence of probe, Purple enriched candidates are defined as proteins with a false discovery rate less than 0.2 and a fold change of at least 1.5-fold, and Orange enriched hits are defined as proteins with a false discovery rate less than 0.05 and a fold change of at least 2-fold in the +UV over the -UV)."

MAStandard(SF_2024_data)

```
:::
:::


## Gene Ontology enrichment

**In beta: GO analysis still under development**

::: {.panel-tabset}


#### Cell Compartment

:::{.border}
```{r, echo=FALSE, warning=FALSE}
# #### These functions make the plots to be displayed in this div - uncomment them to run them again
# CC_enrichment_plots(SF_2024_data, "dot", "/LipidProbe/GO_plots/Sph_SF_2024_CC-DOTplot")
# CC_enrichment_plots(SF_2024_data, "cnet", "/LipidProbe/GO_plots/Sph_SF_2024_CC-CNETplot")
```

<iframe src="/LipidProbe/GO_plots/Sph_SF_2024_CC-DOTplot.html" width="100%" height="500px"></iframe>

(CC CNET plot failed in production)
:::

#### Molecular Function

:::{.border}
```{r, echo=FALSE, warning=FALSE}
#### These functions make the plots to be displayed in this div - uncomment them to run them again
# MF_enrichment_plots(SF_2024_data, "dot", "/LipidProbe/GO_plots/Sph_SF_2024_MF-DOTplot")
# MF_enrichment_plots(SF_2024_data, "cnet", "/LipidProbe/GO_plots/Sph_SF_2024_MF-CNETplot")
```

(No MF pathways identified among enriched hits and candidates.)

(MF CNET plot failed in production)
:::

#### Biological Process

:::{.border}
```{r, echo=FALSE, warning=FALSE}
#### These functions make the plots to be displayed in this div - uncomment them to run them again
# BP_enrichment_plots(SF_2024_data, "dot", "/LipidProbe/GO_plots/Sph_SF_2024_BP-DOTplot")
# BP_enrichment_plots(SF_2024_data, "cnet", "/LipidProbe/GO_plots/Sph_SF_2024_BP-CNETplot")
```

(No BP pathways identified among enriched hits and candidates.)


(BP CNET plot failed in production)
:::
:::

## Data exploration and download

Check the boxes below to filter by significance thresholds.

:::{.border}
```{r, echo=FALSE, warning=FALSE}

# Here is the code to make the filterable lists shown in the crosstalk table below

SF_2024_data <- SF_2024_data |>
  dplyr::select(gene_name, hit_annotation, logFC, pvalue, fdr) |>
  mutate(logFC = signif(logFC, digits=3),
          pvalue = signif(pvalue, digits=3),
          fdr = signif(fdr, digits = 3)) |>
  arrange(hit_annotation)
  
## Creates a reactive dataframe
SF_2024_data_reactive <- crosstalk::SharedData$new(SF_2024_data)

htmltools::tags$div(
  class = "filter-container",
  filter_checkbox(id = "hit_annotation",
                  label = "Enrichment criteria:", 
                  sharedData = SF_2024_data_reactive,
                  group = ~hit_annotation,
                  inline="true")
)

## Displays the reactive dataframe
datatable(SF_2024_data_reactive, 
          caption = "'No hit' proteins are unenriched or depleted in the presence of probe, 'enriched candidates' are defined as proteins with a false discovery rate less than 0.2 and a fold change of at least 1.5-fold, and 'enriched hits' are defined as proteins with a false discovery rate less than 0.05 and a fold change of at least 2-fold in the +UV over the -UV", 
          options = list(pageLength = 10),
                         colnames = c("Gene Name", "Lipid Probe", "Hit Annotation", "LogFC", "p value", "FDR"))

```
:::


{{< downloadthis DataSets/Sph_Huh7_SF_2024.csv dname="Sph_Huh7_SF_ACS-Chem-Bio_download.csv">}}

:::

### Cell background: HeLa


::: {.callout-note collapse="true"}

{{< include /StudyInformation_includes/DH_2017_include.qmd >}}

:::